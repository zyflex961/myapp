"use strict";(self.webpackChunkmytonwallet=self.webpackChunkmytonwallet||[]).push([[983],{13648:(e,t,r)=>{r.d(t,{LocalTracer:()=>a});let o=0;const n=[];class a{type;context;constructor(e,t){this.type=e,this.context=t}trace(e,t){(({type:e,message:t,data:r,context:a})=>{const s={type:e,id:String(++o),date:new Date};t&&(s.message=t),r&&(s.data=r),a&&(s.context=a),function(e){for(let t=0;t<n.length;t++)try{n[t](e)}catch(e){console.error(e)}}(s)})({type:this.type,message:e,data:t,context:this.context})}getContext(){return this.context}setContext(e){this.context=e}updateContext(e){this.context={...this.context,...e}}getType(){return this.type}setType(e){this.type=e}withType(e){return new a(e,this.context)}withContext(e){return new a(this.type,e)}withUpdatedContext(e){return new a(this.type,{...this.context,...e})}}"undefined"!=typeof window&&(window.__ledgerLogsListen=e=>(n.push(e),()=>{const t=n.indexOf(e);-1!==t&&(n[t]=n[n.length-1],n.pop())}))},13983:(e,t,r)=>{r.d(t,{Ay:()=>c});var o=r(37007),n=r.n(o),a=r(24450),s=r(13648),i=r(48287).Buffer;class c{exchangeTimeout=3e4;unresponsiveTimeout=15e3;deviceModel=null;tracer;constructor({context:e,logType:t}={}){this.tracer=new s.LocalTracer(t??"transport",e)}static isSupported;static list;static listen;static open;exchange(e,{abortTimeoutMs:t}={}){throw new Error("exchange not implemented")}exchangeBulk(e,t){let r=!1;return(async()=>{if(!r)for(const o of e){const e=await this.exchange(o);if(r)return;const n=e.readUInt16BE(e.length-2);if(n!==a.StatusCodes.OK)throw new a.TransportStatusError(n);t.next(e)}})().then(()=>!r&&t.complete(),e=>!r&&t.error(e)),{unsubscribe:()=>{r=!0}}}setScrambleKey(e){}close(){return Promise.resolve()}_events=new(n());on(e,t){this._events.on(e,t)}off(e,t){this._events.removeListener(e,t)}emit(e,...t){this._events.emit(e,...t)}setDebugMode(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")}setExchangeTimeout(e){this.exchangeTimeout=e}setExchangeUnresponsiveTimeout(e){this.unresponsiveTimeout=e}send=async(e,t,r,o,n=i.alloc(0),s=[a.StatusCodes.OK],{abortTimeoutMs:c}={})=>{const d=this.tracer.withUpdatedContext({function:"send"});if(n.length>=256)throw d.trace("data.length exceeded 256 bytes limit",{dataLength:n.length}),new a.TransportError("data.length exceed 256 bytes limit. Got: "+n.length,"DataLengthTooBig");d.trace("Starting an exchange",{abortTimeoutMs:c});const u=await this.exchange(i.concat([i.from([e,t,r,o]),i.from([n.length]),n]),{abortTimeoutMs:c});d.trace("Received response from exchange");const E=u.readUInt16BE(u.length-2);if(!s.some(e=>e===E))throw new a.TransportStatusError(E);return u};static create(e=3e3,t){return new Promise((r,o)=>{let n=!1;const s=this.listen({next:t=>{n=!0,s&&s.unsubscribe(),i&&clearTimeout(i),this.open(t.descriptor,e).then(r,o)},error:e=>{i&&clearTimeout(i),o(e)},complete:()=>{i&&clearTimeout(i),n||o(new a.TransportError(this.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),i=t?setTimeout(()=>{s.unsubscribe(),o(new a.TransportError(this.ErrorMessage_ListenTimeout,"ListenTimeout"))},t):null})}exchangeBusyPromise;async exchangeAtomicImpl(e){const t=this.tracer.withUpdatedContext({function:"exchangeAtomicImpl",unresponsiveTimeout:this.unresponsiveTimeout});if(this.exchangeBusyPromise)throw t.trace("Atomic exchange is already busy"),new a.TransportRaceCondition("An action was already pending on the Ledger device. Please deny or reconnect.");let r;const o=new Promise(e=>{r=e});this.exchangeBusyPromise=o;let n=!1;const s=setTimeout(()=>{t.trace('Timeout reached, emitting Transport event "unresponsive"',{unresponsiveTimeout:this.unresponsiveTimeout}),n=!0,this.emit("unresponsive")},this.unresponsiveTimeout);try{const r=await e();return n&&(t.trace("Device was unresponsive, emitting responsive"),this.emit("responsive")),r}finally{t.trace("Finalize, clearing busy guard"),clearTimeout(s),r&&r(),this.exchangeBusyPromise=null}}decorateAppAPIMethods(e,t,r){for(const o of t)e[o]=this.decorateAppAPIMethod(o,e[o],e,r)}_appAPIlock=null;decorateAppAPIMethod(e,t,r,o){return async(...n)=>{const{_appAPIlock:s}=this;if(s)return Promise.reject(new a.TransportError("Ledger Device is busy (lock "+s+")","TransportLocked"));try{return this._appAPIlock=e,this.setScrambleKey(o),await t.apply(r,n)}finally{this._appAPIlock=null}}}setTraceContext(e){this.tracer=this.tracer.withContext(e)}updateTraceContext(e){this.tracer.updateContext(e)}getTraceContext(){return this.tracer.getContext()}static ErrorMessage_ListenTimeout="No Ledger device found (timeout)";static ErrorMessage_NoDeviceFound="No Ledger device found"}},24450:(e,t,r)=>{r.d(t,{StatusCodes:()=>u,TransportError:()=>d,TransportRaceCondition:()=>i,TransportStatusError:()=>E});const o={},n={},a=(e,t)=>{n[e]=t},s=e=>{class t extends Error{cause;constructor(r,o,n){if(super(r||e,n),Object.setPrototypeOf(this,t.prototype),this.name=e,o)for(const e in o)this[e]=o[e];if(n&&"object"==typeof n&&"cause"in n&&!this.cause){const e=n.cause;this.cause=e,"stack"in e&&(this.stack=this.stack+"\nCAUSE: "+e.stack)}}}return o[e]=t,t};s("AccountNameRequired"),s("AccountNotSupported"),s("AccountAwaitingSendPendingOperations"),s("AmountRequired"),s("BluetoothRequired"),s("BtcUnmatchedApp"),s("CantOpenDevice"),s("CashAddrNotSupported"),s("ClaimRewardsFeesWarning"),s("CurrencyNotSupported"),s("DeviceAppVerifyNotSupported"),s("DeviceGenuineSocketEarlyClose"),s("DeviceNotGenuine"),s("DeviceOnDashboardExpected"),s("DeviceOnDashboardUnexpected"),s("DeviceInOSUExpected"),s("DeviceHalted"),s("DeviceNameInvalid"),s("DeviceSocketFail"),s("DeviceSocketNoBulkStatus"),s("DeviceSocketNoBulkStatus"),s("UnresponsiveDeviceError"),s("DisconnectedDevice"),s("DisconnectedDeviceDuringOperation"),s("DeviceExtractOnboardingStateError"),s("DeviceOnboardingStatePollingError"),s("EnpointConfig"),s("EthAppPleaseEnableContractData"),s("CeloAppPleaseEnableContractData"),s("FeeEstimationFailed"),s("FirmwareNotRecognized"),s("HardResetFail"),s("InvalidXRPTag"),s("InvalidAddress"),s("InvalidNonce"),s("InvalidAddressBecauseDestinationIsAlsoSource"),s("LatestMCUInstalledError"),s("LatestFirmwareVersionRequired"),s("UnknownMCU"),s("LedgerAPIError"),s("LedgerAPIErrorWithMessage"),s("LedgerAPINotAvailable"),s("ManagerAppAlreadyInstalled"),s("ManagerAppRelyOnBTC"),s("ManagerAppDepInstallRequired"),s("ManagerAppDepUninstallRequired"),s("ManagerDeviceLocked"),s("ManagerFirmwareNotEnoughSpace"),s("ManagerNotEnoughSpace"),s("ManagerUninstallBTCDep"),s("NetworkDown"),s("NetworkError"),s("NoAddressesFound"),s("NotEnoughBalance"),s("NotEnoughBalanceFees"),s("NotEnoughBalanceSwap"),s("NotEnoughBalanceToDelegate"),s("UnstakeNotEnoughStakedBalanceLeft"),s("RestakeNotEnoughStakedBalanceLeft"),s("NotEnoughToRestake"),s("NotEnoughToUnstake"),s("NotEnoughBalanceInParentAccount"),s("NotEnoughSpendableBalance"),s("NotEnoughBalanceBecauseDestinationNotCreated"),s("NotEnoughToStake"),s("NoAccessToCamera"),s("NotEnoughGas"),s("NotEnoughGasSwap"),s("TronEmptyAccount"),s("MaybeKeepTronAccountAlive"),s("NotSupportedLegacyAddress"),s("GasLessThanEstimate"),s("PriorityFeeTooLow"),s("PriorityFeeTooHigh"),s("PriorityFeeHigherThanMaxFee"),s("MaxFeeTooLow"),s("PasswordsDontMatch"),s("PasswordIncorrect"),s("RecommendSubAccountsToEmpty"),s("RecommendUndelegation"),s("TimeoutTagged"),s("UnexpectedBootloader"),s("MCUNotGenuineToDashboard"),s("RecipientRequired"),s("UnavailableTezosOriginatedAccountReceive"),s("UnavailableTezosOriginatedAccountSend"),s("UpdateFetchFileFail"),s("UpdateIncorrectHash"),s("UpdateIncorrectSig"),s("UpdateYourApp"),s("UserRefusedDeviceNameChange"),s("UserRefusedAddress"),s("UserRefusedFirmwareUpdate"),s("UserRefusedAllowManager"),s("UserRefusedOnDevice"),s("PinNotSet"),s("ExpertModeRequired"),s("TransportOpenUserCancelled"),s("TransportInterfaceNotAvailable");const i=s("TransportRaceCondition");var c;s("TransportWebUSBGestureRequired"),s("TransactionHasBeenValidatedError"),s("TransportExchangeTimeoutError"),s("DeviceShouldStayInApp"),s("WebsocketConnectionError"),s("WebsocketConnectionFailed"),s("WrongDeviceForAccount"),s("WrongDeviceForAccountPayout"),s("MissingSwapPayloadParamaters"),s("WrongDeviceForAccountRefund"),s("WrongAppForCurrency"),s("ETHAddressNonEIP"),s("CantScanQRCode"),s("FeeNotLoaded"),s("FeeNotLoadedSwap"),s("FeeRequired"),s("FeeTooHigh"),s("PendingOperation"),s("SyncError"),s("PairingFailed"),s("PeerRemovedPairing"),s("GenuineCheckFailed"),s("LedgerAPI4xx"),s("LedgerAPI5xx"),s("FirmwareOrAppUpdateRequired"),s("ReplacementTransactionUnderpriced"),s("OpReturnSizeLimit"),s("DustLimit"),s("HederaInsufficientFundsForAssociation"),s("HederaRecipientTokenAssociationRequired"),s("HederaRecipientTokenAssociationUnverified"),s("LanguageNotFound"),s("NoDBPathGiven"),s("DBWrongPassword"),s("DBNotReset"),s("SequenceNumberError"),s("DisabledTransactionBroadcastError"),function(e){e.Unknown="Unknown",e.LocationServicesDisabled="LocationServicesDisabled",e.LocationServicesUnauthorized="LocationServicesUnauthorized",e.BluetoothScanStartFailed="BluetoothScanStartFailed"}(c||(c={})),Error;class d extends Error{id;constructor(e,t){const r="TransportError";super(e||r),this.name=r,this.message=e,this.stack=new Error(e).stack,this.id=t}}a("TransportError",e=>new d(e.message,e.id));const u={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,DEVICE_IN_RECOVERY_MODE:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,DEVICE_NOT_ONBOARDED:27911,DEVICE_NOT_ONBOARDED_2:26129,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761,NOT_ENOUGH_SPACE:20738,APP_NOT_FOUND_OR_INVALID_CONTEXT:20771,INVALID_APP_NAME_LENGTH:26378,GEN_AES_KEY_FAILED:21529,INTERNAL_CRYPTO_OPERATION_FAILED:21530,INTERNAL_COMPUTE_AES_CMAC_FAILED:21531,ENCRYPT_APP_STORAGE_FAILED:21532,INVALID_BACKUP_STATE:26178,PIN_NOT_SET:21762,INVALID_BACKUP_LENGTH:26419,INVALID_RESTORE_STATE:26179,INVALID_CHUNK_LENGTH:26420,INVALID_BACKUP_HEADER:26698,TRUSTCHAIN_WRONG_SEED:45063};class E extends Error{statusCode;statusText;constructor(e,{canBeMappedToChildError:t=!0}={}){const r=Object.keys(u).find(t=>u[t]===e)||"UNKNOWN_ERROR",o=`Ledger device: ${function(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=e&&e<=28671)return"Internal error, please report"}(e)||r} (0x${e.toString(16)})`;if(super(o),this.name="TransportStatusError",this.statusCode=e,this.statusText=r,Object.setPrototypeOf(this,E.prototype),t&&e===u.LOCKED_DEVICE)return new p(o)}}class p extends E{constructor(e){super(u.LOCKED_DEVICE,{canBeMappedToChildError:!1}),e&&(this.message=e),this.name="LockedDeviceError",Object.setPrototypeOf(this,p.prototype)}}Error,a("TransportStatusError",e=>new E(e.statusCode))}}]);
//# sourceMappingURL=983.801be74aee0fe487e3a4.js.map