"use strict";(self.webpackChunkmytonwallet=self.webpackChunkmytonwallet||[]).push([[949],{70949:(t,e,i)=>{i.d(e,{default:()=>I});var s=i(19822);function a(t,e){return e-Math.floor(e/t)*t}var r=i(9705),n=i(14235),o=i(41074),h=i(82393),d=i(66644);const m=Symbol("WAITING"),l=h.Ni||h.pz?.75:1,c=h.Ni?.5:.75,u=24,g=h.Yw?2:4,p=(0,o.Ay)().map(t=>{let{connector:e}=t;return e}),v=new Map,x=new WeakMap;let f=-1;class w{views=new Map;imgSize;imageData;msPerFrame=1e3/60;reduceFactor=1;cacheModulo;workerIndex;frames=[];framesCount;isAnimating=!1;isWaiting=!0;isEnded=!1;isDestroyed=!1;isRendererInited=!1;approxFrameIndex=0;prevFrameIndex=-1;stopFrameIndex=0;speed=1;direction=1;lastRenderAt;static init(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];const[,s,a,r,o=(0,n.A)(),,h]=e;let d=v.get(a);return d?d.addView(o,s,h,null==r?void 0:r.coords):(d=new w(...e),v.set(a,d)),d}constructor(t,e,i,s){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:(0,n.A)(),r=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,h=arguments.length>7?arguments[7]:void 0,d=arguments.length>8?arguments[8]:void 0;this.tgsUrl=t,this.container=e,this.renderId=i,this.params=s,this.customColor=r,this.onLoad=o,this.onEnded=h,this.onLoop=d,this.addView(a,e,o,s.coords),this.initConfig(),this.initRenderer()}removeView(t){const{canvas:e,ctx:i,isSharedCanvas:s,coords:a}=this.views.get(t);s?i.clearRect(a.x,a.y,this.imgSize,this.imgSize):e.remove(),this.views.delete(t),this.views.size||this.destroy()}isPlaying(){return this.isAnimating||this.isWaiting}play(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1?arguments[1]:void 0;e&&(this.views.get(e).isPaused=!1),this.isEnded&&t&&(this.approxFrameIndex=Math.floor(0)),this.stopFrameIndex=void 0,this.direction=1,this.doPlay()}pause(t){this.lastRenderAt=void 0,(!t||(this.views.get(t).isPaused=!0,Array.from(this.views.values()).every(t=>{let{isPaused:e}=t;return e})))&&(this.isWaiting?this.stopFrameIndex=this.approxFrameIndex:this.isAnimating=!1,this.params.isLowPriority||(this.frames=this.frames.map((t,e)=>e===this.prevFrameIndex?t:void(t&&t!==m&&t.close()))))}playSegment(t){let[e,i]=t,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;a&&(this.views.get(a).isPaused=!1);const r=Math.round(this.approxFrameIndex);this.stopFrameIndex=Math.floor(i/this.reduceFactor),(r!==i||s)&&(this.approxFrameIndex=Math.floor(e/this.reduceFactor)),this.direction=e<i?1:-1,this.doPlay()}setSpeed(t){this.speed=t}setNoLoop(t){this.params.noLoop=t}async setSharedCanvasCoords(t,e){const i=this.views.get(t),{canvas:s,ctx:a}=i,r=!s.dataset.isJustCleaned||"false"===s.dataset.isJustCleaned;r||await x.get(s);let[n,o]=[s.width,s.height];if(r){const t=this.calcSizeFactor();[n,o]=F(s,t),a.clearRect(0,0,n,o),s.dataset.isJustCleaned="true",(0,d.YS)(()=>{s.dataset.isJustCleaned="false"})}i.coords={x:Math.round(((null==e?void 0:e.x)||0)*n),y:Math.round(((null==e?void 0:e.y)||0)*o)};const h=this.getFrame(this.prevFrameIndex)||this.getFrame(Math.round(this.approxFrameIndex));h&&h!==m&&a.drawImage(h,i.coords.x,i.coords.y)}addView(t,e,i,s){const a=this.calcSizeFactor();let r;if(e instanceof HTMLDivElement){if(!(e.parentNode instanceof HTMLElement))throw new Error("[RLottie] Container is not mounted");const{size:s,shouldStretch:n}=this.params;r=Math.round(s*a),this.imgSize||(this.imgSize=r,this.imageData=new ImageData(r,r)),(0,d.RK)(()=>{const a=document.createElement("canvas"),o=a.getContext("2d");n?a.style.width="100%":(a.style.width=`${s}px`,a.style.height=`${s}px`),a.style.display="block",a.width=r,a.height=r,e.appendChild(a),this.views.set(t,{canvas:a,ctx:o,onLoad:i})})}else{if(!e.isConnected)throw new Error("[RLottie] Shared canvas is not mounted");const n=e,o=n.getContext("2d");r=Math.round(this.params.size*a),this.imgSize||(this.imgSize=r,this.imageData=new ImageData(r,r));const[h,d]=F(n,a);this.views.set(t,{canvas:n,ctx:o,isSharedCanvas:!0,coords:{x:Math.round(s.x*h),y:Math.round(s.y*d)},onLoad:i})}this.isRendererInited&&this.doPlay()}calcSizeFactor(){const{size:t,isLowPriority:e,quality:i=(e&&(!t||t>u)?c:l)}=this.params;return Math.max(window.devicePixelRatio*i,1)}destroy(){this.isDestroyed=!0,this.pause(),this.clearCache(),this.destroyRenderer(),v.delete(this.renderId)}clearCache(){this.frames.forEach(t=>{t&&t!==m&&t.close()}),this.imageData=void 0,this.frames=[]}initConfig(){const{isLowPriority:t}=this.params;this.cacheModulo=t?0:g}setColor(t){this.customColor=t}initRenderer(){this.workerIndex=a(o.bP,++f),p[this.workerIndex].request({name:"rlottie:init",args:[this.renderId,this.tgsUrl,this.imgSize,this.params.isLowPriority||!1,this.customColor,this.onRendererInit.bind(this)]})}destroyRenderer(){p[this.workerIndex].request({name:"rlottie:destroy",args:[this.renderId]})}onRendererInit(t,e,i){this.isRendererInited=!0,this.reduceFactor=t,this.msPerFrame=e,this.framesCount=i,this.isWaiting&&this.doPlay()}changeData(t){this.pause(),this.tgsUrl=t,this.initConfig(),p[this.workerIndex].request({name:"rlottie:changeData",args:[this.renderId,this.tgsUrl,this.params.isLowPriority||!1,this.onChangeData.bind(this)]})}onChangeData(t,e,i){this.reduceFactor=t,this.msPerFrame=e,this.framesCount=i,this.isWaiting=!1,this.isAnimating=!1,this.doPlay()}doPlay(){this.framesCount&&(this.isDestroyed||this.isAnimating||(this.isWaiting||(this.lastRenderAt=void 0),this.isEnded=!1,this.isAnimating=!0,this.isWaiting=!1,(0,s.i0)(()=>{if(this.isDestroyed)return!1;if(!this.isAnimating&&Array.from(this.views.values()).every(t=>{let{isLoaded:e}=t;return e}))return!1;const t=Math.round(this.approxFrameIndex),e=this.getFrame(t);if(!e||e===m)return e||this.requestFrame(t),this.isAnimating=!1,this.isWaiting=!0,!1;this.cacheModulo&&t%this.cacheModulo===0&&this.cleanupPrevFrame(t),t!==this.prevFrameIndex&&(this.views.forEach(t=>{const{ctx:i,isLoaded:s,isPaused:a,coords:{x:r,y:n}={},onLoad:o}=t;s&&a||(i.clearRect(r||0,n||0,this.imgSize,this.imgSize),i.drawImage(e,r||0,n||0)),s||(t.isLoaded=!0,null==o||o())}),this.prevFrameIndex=t);const i=Date.now(),s=this.lastRenderAt?this.msPerFrame/(i-this.lastRenderAt):1,a=this.direction*this.speed/s,r=Math.round(this.approxFrameIndex+a);if(this.lastRenderAt=i,a>0&&(t===this.framesCount-1||r>this.framesCount-1)){var n,o;if(this.params.noLoop)return this.isAnimating=!1,this.isEnded=!0,null===(o=this.onEnded)||void 0===o||o.call(this),!1;null===(n=this.onLoop)||void 0===n||n.call(this),this.approxFrameIndex=0}else if(a<0&&(0===t||r<0)){var h,d;if(this.params.noLoop)return this.isAnimating=!1,this.isEnded=!0,null===(d=this.onEnded)||void 0===d||d.call(this),!1;null===(h=this.onLoop)||void 0===h||h.call(this),this.approxFrameIndex=this.framesCount-1}else{if(void 0!==this.stopFrameIndex&&(t===this.stopFrameIndex||a>0&&r>this.stopFrameIndex||a<0&&r<this.stopFrameIndex))return this.stopFrameIndex=void 0,this.isAnimating=!1,!1;this.approxFrameIndex+=a}const l=Math.round(this.approxFrameIndex);return!!this.getFrame(l)||(this.requestFrame(l),this.isWaiting=!0,this.isAnimating=!1,!1)},d.RK)))}getFrame(t){return this.frames[t]}requestFrame(t){this.frames[t]=m,p[this.workerIndex].request({name:"rlottie:renderFrames",args:[this.renderId,t,this.onFrameLoad.bind(this)]})}cleanupPrevFrame(t){if(this.framesCount<3)return;const e=a(this.framesCount,t-1);this.frames[e]=void 0}onFrameLoad(t,e){this.frames[t]===m&&(this.frames[t]=e,this.isWaiting&&this.doPlay())}}function F(t,e){const i=Math.round(t.offsetWidth*e),s=Math.round(t.offsetHeight*e);if(t.width!==i||t.height!==s){const e=new r.A;x.set(t,e.promise),(0,d.RK)(()=>{t.width=i,t.height=s,e.resolve()})}return[i,s]}const I=w}}]);
//# sourceMappingURL=949.16fb6c433947772cf2a3.js.map