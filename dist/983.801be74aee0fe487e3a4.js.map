{"version":3,"file":"983.801be74aee0fe487e3a4.js","mappings":"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","sources":["webpack://mytonwallet/./node_modules/@ledgerhq/logs/lib-es/index.js","webpack://mytonwallet/./node_modules/@ledgerhq/hw-transport/lib-es/Transport.js","webpack://mytonwallet/./node_modules/@ledgerhq/errors/lib-es/helpers.js","webpack://mytonwallet/./node_modules/@ledgerhq/errors/lib-es/index.js"],"sourcesContent":["let id = 0;\nconst subscribers = [];\n/**\n * Logs something\n *\n * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n * @param message a clear message of the log associated to the type\n */\nexport const log = (type, message, data) => {\n    const obj = {\n        type,\n        id: String(++id),\n        date: new Date(),\n    };\n    if (message)\n        obj.message = message;\n    if (data)\n        obj.data = data;\n    dispatch(obj);\n};\n/**\n * A simple tracer function, only expanding the existing log function\n *\n * Its goal is to capture more context than a log function.\n * This is simple for now, but can be improved later.\n *\n * @param context Anything representing the context where the log occurred\n */\nexport const trace = ({ type, message, data, context, }) => {\n    const obj = {\n        type,\n        id: String(++id),\n        date: new Date(),\n    };\n    if (message)\n        obj.message = message;\n    if (data)\n        obj.data = data;\n    if (context)\n        obj.context = context;\n    dispatch(obj);\n};\n/**\n * A simple tracer class, that can be used to avoid repetition when using the `trace` function\n *\n * Its goal is to capture more context than a log function.\n * This is simple for now, but can be improved later.\n *\n * @param type A given type (not level) for the current local tracer (\"hw\", \"withDevice\", etc.)\n * @param context Anything representing the context where the log occurred\n */\nexport class LocalTracer {\n    type;\n    context;\n    constructor(type, context) {\n        this.type = type;\n        this.context = context;\n    }\n    trace(message, data) {\n        trace({\n            type: this.type,\n            message,\n            data,\n            context: this.context,\n        });\n    }\n    getContext() {\n        return this.context;\n    }\n    setContext(context) {\n        this.context = context;\n    }\n    updateContext(contextToAdd) {\n        this.context = { ...this.context, ...contextToAdd };\n    }\n    getType() {\n        return this.type;\n    }\n    setType(type) {\n        this.type = type;\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `type`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withType(type) {\n        return new LocalTracer(type, this.context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with a new `context`\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     *\n     * @param context A TraceContext, that can undefined to reset the context\n     */\n    withContext(context) {\n        return new LocalTracer(this.type, context);\n    }\n    /**\n     * Create a new instance of the LocalTracer with an updated `context`,\n     * on which an additional context is merged with the existing one.\n     *\n     * It does not mutate the calling instance, but returns a new LocalTracer,\n     * following a simple builder pattern.\n     */\n    withUpdatedContext(contextToAdd) {\n        return new LocalTracer(this.type, { ...this.context, ...contextToAdd });\n    }\n}\n/**\n * Adds a subscribers to the emitted logs.\n *\n * @param cb that is called for each future log() with the Log object\n * @return a function that can be called to unsubscribe the listener\n */\nexport const listen = (cb) => {\n    subscribers.push(cb);\n    return () => {\n        const i = subscribers.indexOf(cb);\n        if (i !== -1) {\n            // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n            subscribers[i] = subscribers[subscribers.length - 1];\n            subscribers.pop();\n        }\n    };\n};\nfunction dispatch(log) {\n    for (let i = 0; i < subscribers.length; i++) {\n        try {\n            subscribers[i](log);\n        }\n        catch (e) {\n            console.error(e);\n        }\n    }\n}\nif (typeof window !== \"undefined\") {\n    window.__ledgerLogsListen = listen;\n}\n//# sourceMappingURL=index.js.map","import EventEmitter from \"events\";\nimport { TransportRaceCondition, TransportError, StatusCodes, getAltStatusMessage, TransportStatusError, } from \"@ledgerhq/errors\";\nimport { LocalTracer } from \"@ledgerhq/logs\";\nexport { TransportError, TransportStatusError, StatusCodes, getAltStatusMessage };\nconst DEFAULT_LOG_TYPE = \"transport\";\n/**\n * The Transport class defines a generic interface for communicating with a Ledger hardware wallet.\n * There are different kind of transports based on the technology (channels like U2F, HID, Bluetooth, Webusb) and environment (Node, Web,...).\n * It is an abstract class that needs to be implemented.\n */\nexport default class Transport {\n    exchangeTimeout = 30000;\n    unresponsiveTimeout = 15000;\n    deviceModel = null;\n    tracer;\n    constructor({ context, logType } = {}) {\n        this.tracer = new LocalTracer(logType ?? DEFAULT_LOG_TYPE, context);\n    }\n    /**\n     * Check if the transport is supported on the current platform/browser.\n     * @returns {Promise<boolean>} A promise that resolves with a boolean indicating support.\n     */\n    static isSupported;\n    /**\n     * List all available descriptors for the transport.\n     * For a better granularity, checkout `listen()`.\n     *\n     * @returns {Promise<Array<any>>} A promise that resolves with an array of descriptors.\n     * @example\n     * TransportFoo.list().then(descriptors => ...)\n     */\n    static list;\n    /**\n     * Listen for device events for the transport. The method takes an observer of DescriptorEvent and returns a Subscription.\n     * A DescriptorEvent is an object containing a \"descriptor\" and a \"type\" field. The \"type\" field can be \"add\" or \"remove\", and the \"descriptor\" field can be passed to the \"open\" method.\n     * The \"listen\" method will first emit all currently connected devices and then will emit events as they occur, such as when a USB device is plugged in or a Bluetooth device becomes discoverable.\n     * @param {Observer<DescriptorEvent<any>>} observer - An object with \"next\", \"error\", and \"complete\" functions, following the observer pattern.\n     * @returns {Subscription} A Subscription object on which you can call \".unsubscribe()\" to stop listening to descriptors.\n     * @example\n    const sub = TransportFoo.listen({\n    next: e => {\n      if (e.type===\"add\") {\n        sub.unsubscribe();\n        const transport = await TransportFoo.open(e.descriptor);\n        ...\n      }\n    },\n    error: error => {},\n    complete: () => {}\n    })\n     */\n    static listen;\n    /**\n     * Attempt to create a Transport instance with a specific descriptor.\n     * @param {any} descriptor - The descriptor to open the transport with.\n     * @param {number} timeout - An optional timeout for the transport connection.\n     * @param {TraceContext} context Optional tracing/log context\n     * @returns {Promise<Transport>} A promise that resolves with a Transport instance.\n     * @example\n    TransportFoo.open(descriptor).then(transport => ...)\n     */\n    static open;\n    /**\n     * Send data to the device using a low level API.\n     * It's recommended to use the \"send\" method for a higher level API.\n     * @param {Buffer} apdu - The data to send.\n     * @param {Object} options - Contains optional options for the exchange function\n     *  - abortTimeoutMs: stop the exchange after a given timeout. Another timeout exists\n     *    to detect unresponsive device (see `unresponsiveTimeout`). This timeout aborts the exchange.\n     * @returns {Promise<Buffer>} A promise that resolves with the response data from the device.\n     */\n    exchange(_apdu, { abortTimeoutMs: _abortTimeoutMs } = {}) {\n        throw new Error(\"exchange not implemented\");\n    }\n    /**\n     * Send apdus in batch to the device using a low level API.\n     * The default implementation is to call exchange for each apdu.\n     * @param {Array<Buffer>} apdus - array of apdus to send.\n     * @param {Observer<Buffer>} observer - an observer that will receive the response of each apdu.\n     * @returns {Subscription} A Subscription object on which you can call \".unsubscribe()\" to stop sending apdus.\n     */\n    exchangeBulk(apdus, observer) {\n        let unsubscribed = false;\n        const unsubscribe = () => {\n            unsubscribed = true;\n        };\n        const main = async () => {\n            if (unsubscribed)\n                return;\n            for (const apdu of apdus) {\n                const r = await this.exchange(apdu);\n                if (unsubscribed)\n                    return;\n                const status = r.readUInt16BE(r.length - 2);\n                if (status !== StatusCodes.OK) {\n                    throw new TransportStatusError(status);\n                }\n                observer.next(r);\n            }\n        };\n        main().then(() => !unsubscribed && observer.complete(), e => !unsubscribed && observer.error(e));\n        return { unsubscribe };\n    }\n    /**\n     * Set the \"scramble key\" for the next data exchanges with the device.\n     * Each app can have a different scramble key and it is set internally during instantiation.\n     * @param {string} key - The scramble key to set.\n     * deprecated This method is no longer needed for modern transports and should be migrated away from.\n     * no @ before deprecated as it breaks documentationjs on version 14.0.2\n     * https://github.com/documentationjs/documentation/issues/1596\n     */\n    setScrambleKey(_key) { }\n    /**\n     * Close the connection with the device.\n     *\n     * Note: for certain transports (hw-transport-node-hid-singleton for ex), once the promise resolved,\n     * the transport instance is actually still cached, and the device is disconnected only after a defined timeout.\n     * But for the consumer of the Transport, this does not matter and it can consider the transport to be closed.\n     *\n     * @returns {Promise<void>} A promise that resolves when the transport is closed.\n     */\n    close() {\n        return Promise.resolve();\n    }\n    _events = new EventEmitter();\n    /**\n     * Listen for an event on the transport instance.\n     * Transport implementations may have specific events. Common events include:\n     * \"disconnect\" : triggered when the transport is disconnected.\n     * @param {string} eventName - The name of the event to listen for.\n     * @param {(...args: Array<any>) => any} cb - The callback function to be invoked when the event occurs.\n     */\n    on(eventName, cb) {\n        this._events.on(eventName, cb);\n    }\n    /**\n     * Stop listening to an event on an instance of transport.\n     */\n    off(eventName, cb) {\n        this._events.removeListener(eventName, cb);\n    }\n    emit(event, ...args) {\n        this._events.emit(event, ...args);\n    }\n    /**\n     * Enable or not logs of the binary exchange\n     */\n    setDebugMode() {\n        console.warn(\"setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.\");\n    }\n    /**\n     * Set a timeout (in milliseconds) for the exchange call. Only some transport might implement it. (e.g. U2F)\n     */\n    setExchangeTimeout(exchangeTimeout) {\n        this.exchangeTimeout = exchangeTimeout;\n    }\n    /**\n     * Define the delay before emitting \"unresponsive\" on an exchange that does not respond\n     */\n    setExchangeUnresponsiveTimeout(unresponsiveTimeout) {\n        this.unresponsiveTimeout = unresponsiveTimeout;\n    }\n    /**\n     * Send data to the device using the higher level API.\n     *\n     * @param {number} cla - The instruction class for the command.\n     * @param {number} ins - The instruction code for the command.\n     * @param {number} p1 - The first parameter for the instruction.\n     * @param {number} p2 - The second parameter for the instruction.\n     * @param {Buffer} data - The data to be sent. Defaults to an empty buffer.\n     * @param {Array<number>} statusList - A list of acceptable status codes for the response. Defaults to [StatusCodes.OK].\n     * @param {Object} options - Contains optional options for the exchange function\n     *  - abortTimeoutMs: stop the send after a given timeout. Another timeout exists\n     *    to detect unresponsive device (see `unresponsiveTimeout`). This timeout aborts the exchange.\n     * @returns {Promise<Buffer>} A promise that resolves with the response data from the device.\n     */\n    send = async (cla, ins, p1, p2, data = Buffer.alloc(0), statusList = [StatusCodes.OK], { abortTimeoutMs } = {}) => {\n        const tracer = this.tracer.withUpdatedContext({ function: \"send\" });\n        if (data.length >= 256) {\n            tracer.trace(\"data.length exceeded 256 bytes limit\", { dataLength: data.length });\n            throw new TransportError(\"data.length exceed 256 bytes limit. Got: \" + data.length, \"DataLengthTooBig\");\n        }\n        tracer.trace(\"Starting an exchange\", { abortTimeoutMs });\n        const response = await this.exchange(\n        // The size of the data is added in 1 byte just before `data`\n        Buffer.concat([Buffer.from([cla, ins, p1, p2]), Buffer.from([data.length]), data]), { abortTimeoutMs });\n        tracer.trace(\"Received response from exchange\");\n        const sw = response.readUInt16BE(response.length - 2);\n        if (!statusList.some(s => s === sw)) {\n            throw new TransportStatusError(sw);\n        }\n        return response;\n    };\n    /**\n     * create() allows to open the first descriptor available or\n     * throw if there is none or if timeout is reached.\n     * This is a light helper, alternative to using listen() and open() (that you may need for any more advanced usecase)\n     * @example\n    TransportFoo.create().then(transport => ...)\n     */\n    static create(openTimeout = 3000, listenTimeout) {\n        return new Promise((resolve, reject) => {\n            let found = false;\n            const sub = this.listen({\n                next: e => {\n                    found = true;\n                    if (sub)\n                        sub.unsubscribe();\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    this.open(e.descriptor, openTimeout).then(resolve, reject);\n                },\n                error: e => {\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    reject(e);\n                },\n                complete: () => {\n                    if (listenTimeoutId)\n                        clearTimeout(listenTimeoutId);\n                    if (!found) {\n                        reject(new TransportError(this.ErrorMessage_NoDeviceFound, \"NoDeviceFound\"));\n                    }\n                },\n            });\n            const listenTimeoutId = listenTimeout\n                ? setTimeout(() => {\n                    sub.unsubscribe();\n                    reject(new TransportError(this.ErrorMessage_ListenTimeout, \"ListenTimeout\"));\n                }, listenTimeout)\n                : null;\n        });\n    }\n    // Blocks other exchange to happen concurrently\n    exchangeBusyPromise;\n    /**\n     * Wrapper to make an exchange \"atomic\" (blocking any other exchange)\n     *\n     * It also handles \"unresponsiveness\" by emitting \"unresponsive\" and \"responsive\" events.\n     *\n     * @param f The exchange job, using the transport to run\n     * @returns a Promise resolving with the output of the given job\n     */\n    async exchangeAtomicImpl(f) {\n        const tracer = this.tracer.withUpdatedContext({\n            function: \"exchangeAtomicImpl\",\n            unresponsiveTimeout: this.unresponsiveTimeout,\n        });\n        if (this.exchangeBusyPromise) {\n            tracer.trace(\"Atomic exchange is already busy\");\n            throw new TransportRaceCondition(\"An action was already pending on the Ledger device. Please deny or reconnect.\");\n        }\n        // Sets the atomic guard\n        let resolveBusy;\n        const busyPromise = new Promise(r => {\n            resolveBusy = r;\n        });\n        this.exchangeBusyPromise = busyPromise;\n        // The device unresponsiveness handler\n        let unresponsiveReached = false;\n        const timeout = setTimeout(() => {\n            tracer.trace(`Timeout reached, emitting Transport event \"unresponsive\"`, {\n                unresponsiveTimeout: this.unresponsiveTimeout,\n            });\n            unresponsiveReached = true;\n            this.emit(\"unresponsive\");\n        }, this.unresponsiveTimeout);\n        try {\n            const res = await f();\n            if (unresponsiveReached) {\n                tracer.trace(\"Device was unresponsive, emitting responsive\");\n                this.emit(\"responsive\");\n            }\n            return res;\n        }\n        finally {\n            tracer.trace(\"Finalize, clearing busy guard\");\n            clearTimeout(timeout);\n            if (resolveBusy)\n                resolveBusy();\n            this.exchangeBusyPromise = null;\n        }\n    }\n    decorateAppAPIMethods(self, methods, scrambleKey) {\n        for (const methodName of methods) {\n            self[methodName] = this.decorateAppAPIMethod(methodName, self[methodName], self, scrambleKey);\n        }\n    }\n    _appAPIlock = null;\n    decorateAppAPIMethod(methodName, f, ctx, scrambleKey) {\n        return async (...args) => {\n            const { _appAPIlock } = this;\n            if (_appAPIlock) {\n                return Promise.reject(new TransportError(\"Ledger Device is busy (lock \" + _appAPIlock + \")\", \"TransportLocked\"));\n            }\n            try {\n                this._appAPIlock = methodName;\n                this.setScrambleKey(scrambleKey);\n                return await f.apply(ctx, args);\n            }\n            finally {\n                this._appAPIlock = null;\n            }\n        };\n    }\n    /**\n     * Sets the context used by the logging/tracing mechanism\n     *\n     * Useful when re-using (cached) the same Transport instance,\n     * but with a new tracing context.\n     *\n     * @param context A TraceContext, that can undefined to reset the context\n     */\n    setTraceContext(context) {\n        this.tracer = this.tracer.withContext(context);\n    }\n    /**\n     * Updates the context used by the logging/tracing mechanism\n     *\n     * The update only overrides the key-value that are already defined in the current context.\n     *\n     * @param contextToAdd A TraceContext that will be added to the current context\n     */\n    updateTraceContext(contextToAdd) {\n        this.tracer.updateContext(contextToAdd);\n    }\n    /**\n     * Gets the tracing context of the transport instance\n     */\n    getTraceContext() {\n        return this.tracer.getContext();\n    }\n    static ErrorMessage_ListenTimeout = \"No Ledger device found (timeout)\";\n    static ErrorMessage_NoDeviceFound = \"No Ledger device found\";\n}\n//# sourceMappingURL=Transport.js.map","/* eslint-disable no-continue */\n/* eslint-disable no-unused-vars */\n/* eslint-disable no-param-reassign */\n/* eslint-disable no-prototype-builtins */\nconst errorClasses = {};\nconst deserializers = {};\nexport const addCustomErrorDeserializer = (name, deserializer) => {\n    deserializers[name] = deserializer;\n};\nexport const createCustomErrorClass = (name) => {\n    class CustomErrorClass extends Error {\n        cause;\n        constructor(message, fields, options) {\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            super(message || name, options);\n            // Set the prototype explicitly. See https://github.com/Microsoft/TypeScript/wiki/Breaking-Changes#extending-built-ins-like-error-array-and-map-may-no-longer-work\n            Object.setPrototypeOf(this, CustomErrorClass.prototype);\n            this.name = name;\n            if (fields) {\n                for (const k in fields) {\n                    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n                    // @ts-ignore\n                    this[k] = fields[k];\n                }\n            }\n            if (options && isObject(options) && \"cause\" in options && !this.cause) {\n                // .cause was specified but the superconstructor\n                // did not create an instance property.\n                const cause = options.cause;\n                this.cause = cause;\n                if (\"stack\" in cause) {\n                    this.stack = this.stack + \"\\nCAUSE: \" + cause.stack;\n                }\n            }\n        }\n    }\n    errorClasses[name] = CustomErrorClass;\n    return CustomErrorClass;\n};\nfunction isObject(value) {\n    return typeof value === \"object\";\n}\n// inspired from https://github.com/programble/errio/blob/master/index.js\nexport const deserializeError = (object) => {\n    if (object && typeof object === \"object\") {\n        try {\n            if (typeof object.message === \"string\") {\n                const msg = JSON.parse(object.message);\n                if (msg.message && msg.name) {\n                    object = msg;\n                }\n            }\n        }\n        catch (e) {\n            // nothing\n        }\n        let error;\n        if (typeof object.name === \"string\") {\n            const { name } = object;\n            const des = deserializers[name];\n            if (des) {\n                error = des(object);\n            }\n            else {\n                let constructor = name === \"Error\" ? Error : errorClasses[name];\n                if (!constructor) {\n                    console.warn(\"deserializing an unknown class '\" + name + \"'\");\n                    constructor = createCustomErrorClass(name);\n                }\n                error = Object.create(constructor.prototype);\n                try {\n                    for (const prop in object) {\n                        if (object.hasOwnProperty(prop)) {\n                            error[prop] = object[prop];\n                        }\n                    }\n                }\n                catch (e) {\n                    // sometimes setting a property can fail (e.g. .name)\n                }\n            }\n        }\n        else {\n            if (typeof object.message === \"string\") {\n                error = new Error(object.message);\n            }\n        }\n        if (error && !error.stack && Error.captureStackTrace) {\n            Error.captureStackTrace(error, deserializeError);\n        }\n        return error;\n    }\n    return new Error(String(object));\n};\n// inspired from https://github.com/sindresorhus/serialize-error/blob/master/index.js\nexport const serializeError = (value) => {\n    if (!value)\n        return value;\n    if (typeof value === \"object\") {\n        return destroyCircular(value, []);\n    }\n    if (typeof value === \"function\") {\n        return `[Function: ${value.name || \"anonymous\"}]`;\n    }\n    return value;\n};\n// https://www.npmjs.com/package/destroy-circular\nfunction destroyCircular(from, seen) {\n    const to = {};\n    seen.push(from);\n    for (const key of Object.keys(from)) {\n        const value = from[key];\n        if (typeof value === \"function\") {\n            continue;\n        }\n        if (!value || typeof value !== \"object\") {\n            to[key] = value;\n            continue;\n        }\n        if (seen.indexOf(from[key]) === -1) {\n            to[key] = destroyCircular(from[key], seen.slice(0));\n            continue;\n        }\n        to[key] = \"[Circular]\";\n    }\n    if (typeof from.name === \"string\") {\n        to.name = from.name;\n    }\n    if (typeof from.message === \"string\") {\n        to.message = from.message;\n    }\n    if (typeof from.stack === \"string\") {\n        to.stack = from.stack;\n    }\n    return to;\n}\n//# sourceMappingURL=helpers.js.map","import { serializeError, deserializeError, createCustomErrorClass, addCustomErrorDeserializer, } from \"./helpers\";\nexport { serializeError, deserializeError, createCustomErrorClass, addCustomErrorDeserializer };\nexport const AccountNameRequiredError = createCustomErrorClass(\"AccountNameRequired\");\nexport const AccountNotSupported = createCustomErrorClass(\"AccountNotSupported\");\nexport const AccountAwaitingSendPendingOperations = createCustomErrorClass(\"AccountAwaitingSendPendingOperations\");\nexport const AmountRequired = createCustomErrorClass(\"AmountRequired\");\nexport const BluetoothRequired = createCustomErrorClass(\"BluetoothRequired\");\nexport const BtcUnmatchedApp = createCustomErrorClass(\"BtcUnmatchedApp\");\nexport const CantOpenDevice = createCustomErrorClass(\"CantOpenDevice\");\nexport const CashAddrNotSupported = createCustomErrorClass(\"CashAddrNotSupported\");\nexport const ClaimRewardsFeesWarning = createCustomErrorClass(\"ClaimRewardsFeesWarning\");\nexport const CurrencyNotSupported = createCustomErrorClass(\"CurrencyNotSupported\");\nexport const DeviceAppVerifyNotSupported = createCustomErrorClass(\"DeviceAppVerifyNotSupported\");\nexport const DeviceGenuineSocketEarlyClose = createCustomErrorClass(\"DeviceGenuineSocketEarlyClose\");\nexport const DeviceNotGenuineError = createCustomErrorClass(\"DeviceNotGenuine\");\nexport const DeviceOnDashboardExpected = createCustomErrorClass(\"DeviceOnDashboardExpected\");\nexport const DeviceOnDashboardUnexpected = createCustomErrorClass(\"DeviceOnDashboardUnexpected\");\nexport const DeviceInOSUExpected = createCustomErrorClass(\"DeviceInOSUExpected\");\nexport const DeviceHalted = createCustomErrorClass(\"DeviceHalted\");\nexport const DeviceNameInvalid = createCustomErrorClass(\"DeviceNameInvalid\");\nexport const DeviceSocketFail = createCustomErrorClass(\"DeviceSocketFail\");\nexport const DeviceSocketNoBulkStatus = createCustomErrorClass(\"DeviceSocketNoBulkStatus\");\nexport const DeviceNeedsRestart = createCustomErrorClass(\"DeviceSocketNoBulkStatus\");\nexport const UnresponsiveDeviceError = createCustomErrorClass(\"UnresponsiveDeviceError\");\nexport const DisconnectedDevice = createCustomErrorClass(\"DisconnectedDevice\");\nexport const DisconnectedDeviceDuringOperation = createCustomErrorClass(\"DisconnectedDeviceDuringOperation\");\nexport const DeviceExtractOnboardingStateError = createCustomErrorClass(\"DeviceExtractOnboardingStateError\");\nexport const DeviceOnboardingStatePollingError = createCustomErrorClass(\"DeviceOnboardingStatePollingError\");\nexport const EnpointConfigError = createCustomErrorClass(\"EnpointConfig\");\nexport const EthAppPleaseEnableContractData = createCustomErrorClass(\"EthAppPleaseEnableContractData\");\nexport const CeloAppPleaseEnableContractData = createCustomErrorClass(\"CeloAppPleaseEnableContractData\");\nexport const FeeEstimationFailed = createCustomErrorClass(\"FeeEstimationFailed\");\nexport const FirmwareNotRecognized = createCustomErrorClass(\"FirmwareNotRecognized\");\nexport const HardResetFail = createCustomErrorClass(\"HardResetFail\");\nexport const InvalidXRPTag = createCustomErrorClass(\"InvalidXRPTag\");\nexport const InvalidAddress = createCustomErrorClass(\"InvalidAddress\");\nexport const InvalidNonce = createCustomErrorClass(\"InvalidNonce\");\nexport const InvalidAddressBecauseDestinationIsAlsoSource = createCustomErrorClass(\"InvalidAddressBecauseDestinationIsAlsoSource\");\nexport const LatestMCUInstalledError = createCustomErrorClass(\"LatestMCUInstalledError\");\nexport const LatestFirmwareVersionRequired = createCustomErrorClass(\"LatestFirmwareVersionRequired\");\nexport const UnknownMCU = createCustomErrorClass(\"UnknownMCU\");\nexport const LedgerAPIError = createCustomErrorClass(\"LedgerAPIError\");\nexport const LedgerAPIErrorWithMessage = createCustomErrorClass(\"LedgerAPIErrorWithMessage\");\nexport const LedgerAPINotAvailable = createCustomErrorClass(\"LedgerAPINotAvailable\");\nexport const ManagerAppAlreadyInstalledError = createCustomErrorClass(\"ManagerAppAlreadyInstalled\");\nexport const ManagerAppRelyOnBTCError = createCustomErrorClass(\"ManagerAppRelyOnBTC\");\nexport const ManagerAppDepInstallRequired = createCustomErrorClass(\"ManagerAppDepInstallRequired\");\nexport const ManagerAppDepUninstallRequired = createCustomErrorClass(\"ManagerAppDepUninstallRequired\");\nexport const ManagerDeviceLockedError = createCustomErrorClass(\"ManagerDeviceLocked\");\nexport const ManagerFirmwareNotEnoughSpaceError = createCustomErrorClass(\"ManagerFirmwareNotEnoughSpace\");\nexport const ManagerNotEnoughSpaceError = createCustomErrorClass(\"ManagerNotEnoughSpace\");\nexport const ManagerUninstallBTCDep = createCustomErrorClass(\"ManagerUninstallBTCDep\");\nexport const NetworkDown = createCustomErrorClass(\"NetworkDown\");\nexport const NetworkError = createCustomErrorClass(\"NetworkError\");\nexport const NoAddressesFound = createCustomErrorClass(\"NoAddressesFound\");\nexport const NotEnoughBalance = createCustomErrorClass(\"NotEnoughBalance\");\nexport const NotEnoughBalanceFees = createCustomErrorClass(\"NotEnoughBalanceFees\");\nexport const NotEnoughBalanceSwap = createCustomErrorClass(\"NotEnoughBalanceSwap\");\nexport const NotEnoughBalanceToDelegate = createCustomErrorClass(\"NotEnoughBalanceToDelegate\");\nexport const UnstakeNotEnoughStakedBalanceLeft = createCustomErrorClass(\"UnstakeNotEnoughStakedBalanceLeft\");\nexport const RestakeNotEnoughStakedBalanceLeft = createCustomErrorClass(\"RestakeNotEnoughStakedBalanceLeft\");\nexport const NotEnoughToRestake = createCustomErrorClass(\"NotEnoughToRestake\");\nexport const NotEnoughToUnstake = createCustomErrorClass(\"NotEnoughToUnstake\");\nexport const NotEnoughBalanceInParentAccount = createCustomErrorClass(\"NotEnoughBalanceInParentAccount\");\nexport const NotEnoughSpendableBalance = createCustomErrorClass(\"NotEnoughSpendableBalance\");\nexport const NotEnoughBalanceBecauseDestinationNotCreated = createCustomErrorClass(\"NotEnoughBalanceBecauseDestinationNotCreated\");\nexport const NotEnoughToStake = createCustomErrorClass(\"NotEnoughToStake\");\nexport const NoAccessToCamera = createCustomErrorClass(\"NoAccessToCamera\");\nexport const NotEnoughGas = createCustomErrorClass(\"NotEnoughGas\");\n// Error message specifically for the PTX swap flow\nexport const NotEnoughGasSwap = createCustomErrorClass(\"NotEnoughGasSwap\");\nexport const TronEmptyAccount = createCustomErrorClass(\"TronEmptyAccount\");\nexport const MaybeKeepTronAccountAlive = createCustomErrorClass(\"MaybeKeepTronAccountAlive\");\nexport const NotSupportedLegacyAddress = createCustomErrorClass(\"NotSupportedLegacyAddress\");\nexport const GasLessThanEstimate = createCustomErrorClass(\"GasLessThanEstimate\");\nexport const PriorityFeeTooLow = createCustomErrorClass(\"PriorityFeeTooLow\");\nexport const PriorityFeeTooHigh = createCustomErrorClass(\"PriorityFeeTooHigh\");\nexport const PriorityFeeHigherThanMaxFee = createCustomErrorClass(\"PriorityFeeHigherThanMaxFee\");\nexport const MaxFeeTooLow = createCustomErrorClass(\"MaxFeeTooLow\");\nexport const PasswordsDontMatchError = createCustomErrorClass(\"PasswordsDontMatch\");\nexport const PasswordIncorrectError = createCustomErrorClass(\"PasswordIncorrect\");\nexport const RecommendSubAccountsToEmpty = createCustomErrorClass(\"RecommendSubAccountsToEmpty\");\nexport const RecommendUndelegation = createCustomErrorClass(\"RecommendUndelegation\");\nexport const TimeoutTagged = createCustomErrorClass(\"TimeoutTagged\");\nexport const UnexpectedBootloader = createCustomErrorClass(\"UnexpectedBootloader\");\nexport const MCUNotGenuineToDashboard = createCustomErrorClass(\"MCUNotGenuineToDashboard\");\nexport const RecipientRequired = createCustomErrorClass(\"RecipientRequired\");\nexport const UnavailableTezosOriginatedAccountReceive = createCustomErrorClass(\"UnavailableTezosOriginatedAccountReceive\");\nexport const UnavailableTezosOriginatedAccountSend = createCustomErrorClass(\"UnavailableTezosOriginatedAccountSend\");\nexport const UpdateFetchFileFail = createCustomErrorClass(\"UpdateFetchFileFail\");\nexport const UpdateIncorrectHash = createCustomErrorClass(\"UpdateIncorrectHash\");\nexport const UpdateIncorrectSig = createCustomErrorClass(\"UpdateIncorrectSig\");\nexport const UpdateYourApp = createCustomErrorClass(\"UpdateYourApp\");\nexport const UserRefusedDeviceNameChange = createCustomErrorClass(\"UserRefusedDeviceNameChange\");\nexport const UserRefusedAddress = createCustomErrorClass(\"UserRefusedAddress\");\nexport const UserRefusedFirmwareUpdate = createCustomErrorClass(\"UserRefusedFirmwareUpdate\");\nexport const UserRefusedAllowManager = createCustomErrorClass(\"UserRefusedAllowManager\");\nexport const UserRefusedOnDevice = createCustomErrorClass(\"UserRefusedOnDevice\"); // TODO rename because it's just for transaction refusal\nexport const PinNotSet = createCustomErrorClass(\"PinNotSet\");\nexport const ExpertModeRequired = createCustomErrorClass(\"ExpertModeRequired\");\nexport const TransportOpenUserCancelled = createCustomErrorClass(\"TransportOpenUserCancelled\");\nexport const TransportInterfaceNotAvailable = createCustomErrorClass(\"TransportInterfaceNotAvailable\");\nexport const TransportRaceCondition = createCustomErrorClass(\"TransportRaceCondition\");\nexport const TransportWebUSBGestureRequired = createCustomErrorClass(\"TransportWebUSBGestureRequired\");\nexport const TransactionHasBeenValidatedError = createCustomErrorClass(\"TransactionHasBeenValidatedError\");\nexport const TransportExchangeTimeoutError = createCustomErrorClass(\"TransportExchangeTimeoutError\");\nexport const DeviceShouldStayInApp = createCustomErrorClass(\"DeviceShouldStayInApp\");\nexport const WebsocketConnectionError = createCustomErrorClass(\"WebsocketConnectionError\");\nexport const WebsocketConnectionFailed = createCustomErrorClass(\"WebsocketConnectionFailed\");\nexport const WrongDeviceForAccount = createCustomErrorClass(\"WrongDeviceForAccount\");\nexport const WrongDeviceForAccountPayout = createCustomErrorClass(\"WrongDeviceForAccountPayout\");\nexport const MissingSwapPayloadParamaters = createCustomErrorClass(\"MissingSwapPayloadParamaters\");\nexport const WrongDeviceForAccountRefund = createCustomErrorClass(\"WrongDeviceForAccountRefund\");\nexport const WrongAppForCurrency = createCustomErrorClass(\"WrongAppForCurrency\");\nexport const ETHAddressNonEIP = createCustomErrorClass(\"ETHAddressNonEIP\");\nexport const CantScanQRCode = createCustomErrorClass(\"CantScanQRCode\");\nexport const FeeNotLoaded = createCustomErrorClass(\"FeeNotLoaded\");\nexport const FeeNotLoadedSwap = createCustomErrorClass(\"FeeNotLoadedSwap\");\nexport const FeeRequired = createCustomErrorClass(\"FeeRequired\");\nexport const FeeTooHigh = createCustomErrorClass(\"FeeTooHigh\");\nexport const PendingOperation = createCustomErrorClass(\"PendingOperation\");\nexport const SyncError = createCustomErrorClass(\"SyncError\");\nexport const PairingFailed = createCustomErrorClass(\"PairingFailed\");\nexport const PeerRemovedPairing = createCustomErrorClass(\"PeerRemovedPairing\");\nexport const GenuineCheckFailed = createCustomErrorClass(\"GenuineCheckFailed\");\nexport const LedgerAPI4xx = createCustomErrorClass(\"LedgerAPI4xx\");\nexport const LedgerAPI5xx = createCustomErrorClass(\"LedgerAPI5xx\");\nexport const FirmwareOrAppUpdateRequired = createCustomErrorClass(\"FirmwareOrAppUpdateRequired\");\n// SpeedUp / Cancel EVM tx\nexport const ReplacementTransactionUnderpriced = createCustomErrorClass(\"ReplacementTransactionUnderpriced\");\n// Bitcoin family\nexport const OpReturnDataSizeLimit = createCustomErrorClass(\"OpReturnSizeLimit\");\nexport const DustLimit = createCustomErrorClass(\"DustLimit\");\n// Hedera family\nexport const HederaInsufficientFundsForAssociation = createCustomErrorClass(\"HederaInsufficientFundsForAssociation\");\nexport const HederaRecipientTokenAssociationRequired = createCustomErrorClass(\"HederaRecipientTokenAssociationRequired\");\nexport const HederaRecipientTokenAssociationUnverified = createCustomErrorClass(\"HederaRecipientTokenAssociationUnverified\");\n// Language\nexport const LanguageNotFound = createCustomErrorClass(\"LanguageNotFound\");\n// db stuff, no need to translate\nexport const NoDBPathGiven = createCustomErrorClass(\"NoDBPathGiven\");\nexport const DBWrongPassword = createCustomErrorClass(\"DBWrongPassword\");\nexport const DBNotReset = createCustomErrorClass(\"DBNotReset\");\nexport const SequenceNumberError = createCustomErrorClass(\"SequenceNumberError\");\nexport const DisabledTransactionBroadcastError = createCustomErrorClass(\"DisabledTransactionBroadcastError\");\n/**\n * Type of a Transport error used to represent all equivalent errors coming from all possible implementation of Transport\n */\nexport var HwTransportErrorType;\n(function (HwTransportErrorType) {\n    HwTransportErrorType[\"Unknown\"] = \"Unknown\";\n    HwTransportErrorType[\"LocationServicesDisabled\"] = \"LocationServicesDisabled\";\n    HwTransportErrorType[\"LocationServicesUnauthorized\"] = \"LocationServicesUnauthorized\";\n    HwTransportErrorType[\"BluetoothScanStartFailed\"] = \"BluetoothScanStartFailed\";\n})(HwTransportErrorType || (HwTransportErrorType = {}));\n/**\n * Represents an error coming from the usage of any Transport implementation.\n *\n * Needed to map a specific implementation error into an error that\n * can be managed by any code unaware of the specific Transport implementation\n * that was used.\n */\nexport class HwTransportError extends Error {\n    type;\n    constructor(type, message) {\n        super(message);\n        this.name = \"HwTransportError\";\n        this.type = type;\n        // Needed as long as we target < ES6\n        Object.setPrototypeOf(this, HwTransportError.prototype);\n    }\n}\n/**\n * TransportError is used for any generic transport errors.\n * e.g. Error thrown when data received by exchanges are incorrect or if exchanged failed to communicate with the device for various reason.\n */\nexport class TransportError extends Error {\n    id;\n    constructor(message, id) {\n        const name = \"TransportError\";\n        super(message || name);\n        this.name = name;\n        this.message = message;\n        this.stack = new Error(message).stack;\n        this.id = id;\n    }\n}\naddCustomErrorDeserializer(\"TransportError\", e => new TransportError(e.message, e.id));\nexport const StatusCodes = {\n    ACCESS_CONDITION_NOT_FULFILLED: 0x9804,\n    ALGORITHM_NOT_SUPPORTED: 0x9484,\n    CLA_NOT_SUPPORTED: 0x6e00,\n    CODE_BLOCKED: 0x9840,\n    CODE_NOT_INITIALIZED: 0x9802,\n    COMMAND_INCOMPATIBLE_FILE_STRUCTURE: 0x6981,\n    CONDITIONS_OF_USE_NOT_SATISFIED: 0x6985,\n    CONTRADICTION_INVALIDATION: 0x9810,\n    CONTRADICTION_SECRET_CODE_STATUS: 0x9808,\n    DEVICE_IN_RECOVERY_MODE: 0x662f,\n    CUSTOM_IMAGE_EMPTY: 0x662e,\n    FILE_ALREADY_EXISTS: 0x6a89,\n    FILE_NOT_FOUND: 0x9404,\n    GP_AUTH_FAILED: 0x6300,\n    HALTED: 0x6faa,\n    INCONSISTENT_FILE: 0x9408,\n    INCORRECT_DATA: 0x6a80,\n    INCORRECT_LENGTH: 0x6700,\n    INCORRECT_P1_P2: 0x6b00,\n    INS_NOT_SUPPORTED: 0x6d00,\n    DEVICE_NOT_ONBOARDED: 0x6d07,\n    DEVICE_NOT_ONBOARDED_2: 0x6611,\n    INVALID_KCV: 0x9485,\n    INVALID_OFFSET: 0x9402,\n    LICENSING: 0x6f42,\n    LOCKED_DEVICE: 0x5515,\n    MAX_VALUE_REACHED: 0x9850,\n    MEMORY_PROBLEM: 0x9240,\n    MISSING_CRITICAL_PARAMETER: 0x6800,\n    NO_EF_SELECTED: 0x9400,\n    NOT_ENOUGH_MEMORY_SPACE: 0x6a84,\n    OK: 0x9000,\n    PIN_REMAINING_ATTEMPTS: 0x63c0,\n    REFERENCED_DATA_NOT_FOUND: 0x6a88,\n    SECURITY_STATUS_NOT_SATISFIED: 0x6982,\n    TECHNICAL_PROBLEM: 0x6f00,\n    UNKNOWN_APDU: 0x6d02,\n    USER_REFUSED_ON_DEVICE: 0x5501,\n    NOT_ENOUGH_SPACE: 0x5102,\n    APP_NOT_FOUND_OR_INVALID_CONTEXT: 0x5123,\n    INVALID_APP_NAME_LENGTH: 0x670a,\n    GEN_AES_KEY_FAILED: 0x5419,\n    INTERNAL_CRYPTO_OPERATION_FAILED: 0x541a,\n    INTERNAL_COMPUTE_AES_CMAC_FAILED: 0x541b,\n    ENCRYPT_APP_STORAGE_FAILED: 0x541c,\n    INVALID_BACKUP_STATE: 0x6642,\n    PIN_NOT_SET: 0x5502,\n    INVALID_BACKUP_LENGTH: 0x6733,\n    INVALID_RESTORE_STATE: 0x6643,\n    INVALID_CHUNK_LENGTH: 0x6734,\n    INVALID_BACKUP_HEADER: 0x684a,\n    // Not documented:\n    TRUSTCHAIN_WRONG_SEED: 0xb007,\n};\nexport function getAltStatusMessage(code) {\n    switch (code) {\n        // improve text of most common errors\n        case 0x6700:\n            return \"Incorrect length\";\n        case 0x6800:\n            return \"Missing critical parameter\";\n        case 0x6982:\n            return \"Security not satisfied (dongle locked or have invalid access rights)\";\n        case 0x6985:\n            return \"Condition of use not satisfied (denied by the user?)\";\n        case 0x6a80:\n            return \"Invalid data received\";\n        case 0x6b00:\n            return \"Invalid parameter received\";\n        case 0x5515:\n            return \"Locked device\";\n    }\n    if (0x6f00 <= code && code <= 0x6fff) {\n        return \"Internal error, please report\";\n    }\n}\n/**\n * Error thrown when a device returned a non success status.\n * the error.statusCode is one of the `StatusCodes` exported by this library.\n */\nexport class TransportStatusError extends Error {\n    statusCode;\n    statusText;\n    /**\n     * @param statusCode The error status code coming from a Transport implementation\n     * @param options containing:\n     *  - canBeMappedToChildError: enable the mapping of TransportStatusError to an error extending/inheriting from it\n     *  . Ex: LockedDeviceError. Default to true.\n     */\n    constructor(statusCode, { canBeMappedToChildError = true } = {}) {\n        const statusText = Object.keys(StatusCodes).find(k => StatusCodes[k] === statusCode) || \"UNKNOWN_ERROR\";\n        const smsg = getAltStatusMessage(statusCode) || statusText;\n        const statusCodeStr = statusCode.toString(16);\n        const message = `Ledger device: ${smsg} (0x${statusCodeStr})`;\n        super(message);\n        this.name = \"TransportStatusError\";\n        this.statusCode = statusCode;\n        this.statusText = statusText;\n        Object.setPrototypeOf(this, TransportStatusError.prototype);\n        // Maps to a LockedDeviceError\n        if (canBeMappedToChildError && statusCode === StatusCodes.LOCKED_DEVICE) {\n            return new LockedDeviceError(message);\n        }\n    }\n}\nexport class LockedDeviceError extends TransportStatusError {\n    constructor(message) {\n        super(StatusCodes.LOCKED_DEVICE, { canBeMappedToChildError: false });\n        if (message) {\n            this.message = message;\n        }\n        this.name = \"LockedDeviceError\";\n        Object.setPrototypeOf(this, LockedDeviceError.prototype);\n    }\n}\nexport class DeviceMangementKitError extends Error {\n    constructor(name, message) {\n        super(message);\n        this.name = name;\n        Object.setPrototypeOf(this, DeviceMangementKitError.prototype);\n    }\n}\naddCustomErrorDeserializer(\"TransportStatusError\", e => new TransportStatusError(e.statusCode));\n//# sourceMappingURL=index.js.map"],"names":["id","subscribers","LocalTracer","type","context","constructor","this","trace","message","data","obj","String","date","Date","log","i","length","e","console","error","dispatch","getContext","setContext","updateContext","contextToAdd","getType","setType","withType","withContext","withUpdatedContext","window","__ledgerLogsListen","cb","push","indexOf","pop","Transport","exchangeTimeout","unresponsiveTimeout","deviceModel","tracer","logType","static","exchange","_apdu","abortTimeoutMs","_abortTimeoutMs","Error","exchangeBulk","apdus","observer","unsubscribed","async","apdu","r","status","readUInt16BE","StatusCodes","OK","TransportStatusError","next","main","then","complete","unsubscribe","setScrambleKey","_key","close","Promise","resolve","_events","on","eventName","off","removeListener","emit","event","args","setDebugMode","warn","setExchangeTimeout","setExchangeUnresponsiveTimeout","send","cla","ins","p1","p2","Buffer","alloc","statusList","function","dataLength","TransportError","response","concat","from","sw","some","s","create","openTimeout","listenTimeout","reject","found","sub","listen","listenTimeoutId","clearTimeout","open","descriptor","ErrorMessage_NoDeviceFound","setTimeout","ErrorMessage_ListenTimeout","exchangeBusyPromise","exchangeAtomicImpl","f","TransportRaceCondition","resolveBusy","busyPromise","unresponsiveReached","timeout","res","decorateAppAPIMethods","self","methods","scrambleKey","methodName","decorateAppAPIMethod","_appAPIlock","ctx","apply","setTraceContext","updateTraceContext","getTraceContext","errorClasses","deserializers","addCustomErrorDeserializer","name","deserializer","createCustomErrorClass","CustomErrorClass","cause","fields","options","super","Object","setPrototypeOf","prototype","k","stack","HwTransportErrorType","ACCESS_CONDITION_NOT_FULFILLED","ALGORITHM_NOT_SUPPORTED","CLA_NOT_SUPPORTED","CODE_BLOCKED","CODE_NOT_INITIALIZED","COMMAND_INCOMPATIBLE_FILE_STRUCTURE","CONDITIONS_OF_USE_NOT_SATISFIED","CONTRADICTION_INVALIDATION","CONTRADICTION_SECRET_CODE_STATUS","DEVICE_IN_RECOVERY_MODE","CUSTOM_IMAGE_EMPTY","FILE_ALREADY_EXISTS","FILE_NOT_FOUND","GP_AUTH_FAILED","HALTED","INCONSISTENT_FILE","INCORRECT_DATA","INCORRECT_LENGTH","INCORRECT_P1_P2","INS_NOT_SUPPORTED","DEVICE_NOT_ONBOARDED","DEVICE_NOT_ONBOARDED_2","INVALID_KCV","INVALID_OFFSET","LICENSING","LOCKED_DEVICE","MAX_VALUE_REACHED","MEMORY_PROBLEM","MISSING_CRITICAL_PARAMETER","NO_EF_SELECTED","NOT_ENOUGH_MEMORY_SPACE","PIN_REMAINING_ATTEMPTS","REFERENCED_DATA_NOT_FOUND","SECURITY_STATUS_NOT_SATISFIED","TECHNICAL_PROBLEM","UNKNOWN_APDU","USER_REFUSED_ON_DEVICE","NOT_ENOUGH_SPACE","APP_NOT_FOUND_OR_INVALID_CONTEXT","INVALID_APP_NAME_LENGTH","GEN_AES_KEY_FAILED","INTERNAL_CRYPTO_OPERATION_FAILED","INTERNAL_COMPUTE_AES_CMAC_FAILED","ENCRYPT_APP_STORAGE_FAILED","INVALID_BACKUP_STATE","PIN_NOT_SET","INVALID_BACKUP_LENGTH","INVALID_RESTORE_STATE","INVALID_CHUNK_LENGTH","INVALID_BACKUP_HEADER","TRUSTCHAIN_WRONG_SEED","statusCode","statusText","canBeMappedToChildError","keys","find","code","getAltStatusMessage","toString","LockedDeviceError"],"sourceRoot":""}